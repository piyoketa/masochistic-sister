# 勝利報酬デモ実装計画（Victory Modal Demo）

## 目的
- Battle 勝利時の報酬選択フローを試せるデモ画面を用意する。
- 報酬項目（HP回復/所持金獲得/新規カード獲得）をクリックで消化し、フィールドに戻るまでの流れを確認できるようにする。

## 前提/要件
- playerStore に「所持金」を追加。
- Battle 中に MemoryManager で新規作成されたカードへ CardTag `[新規]` を付与する。（デモでは新規タグ付きのカードリストを用意）
- デモ画面（VictoryModalDemoView など）で victory 状態のモーダルを表示し、報酬を一覧表示。

## デモ画面仕様
- 報酬リスト（3項目）
  1. HP回復: HP+75
  2. 所持金獲得: 固定 30（実際のスコア計算はモック）
  3. 新規カード獲得: `[新規]` タグ付きカードリストを CardList.vue で表示し、1枚選択して獲得
- 報酬アイテムはクリックすると即時に処理され、リストから消える。
- 「フィールドに戻る」ボタン: クリックで現在のマスをクリア扱いにし、`/field` へ遷移。

## 実装タスク
1. **playerStore 拡張**
   - 所持金 (gold) を state に追加。初期値 0。
   - `addGold(amount)` / `spendGold(amount)` / `setGold(value)` などの簡易 API を追加。
2. **MemoryManager 拡張**
   - 新規生成カードに CardTag `[新規]` を付与（タグ ID 例: `tag-newly-created`）。デモではモックカードを用意するが、ドメイン側でもタグ付与を実装。
3. **Victory デモビュー**
   - 新規 View `VictoryDemoView.vue`（仮名）を追加し、勝利モーダルを常時表示。
   - 報酬データをローカル state に持ち、クリックで消化→非表示。
   - HP/Gold 表示と更新を playerStore と連動。
   - 新規カード候補を `[新規]` タグ付きの CardInfo[] として用意し、CardList を選択モードで表示。選択→「獲得」ボタンでデッキへ追加し、報酬を消化。
4. **ルーティング・リンク**
   - `/demo/victory-reward` のようなルートを追加。
   - TitleView のデモセクションにリンク追加。
5. **フィールドへの戻り処理**
   - デモでは `useFieldStore` を呼び出し、`markCurrentCleared()` + `selectNextNode` 等は実施せず、単純に `/field` に遷移（クリアフラグだけ設定）。

## 不明点・確認事項（暫定方針）
- デッキへ追加するカード形式: 現状の DeckCardBlueprint に `[新規]` タグ付きカードをどう反映するか（暫定: 既存カード種別のどれかを新規タグ付き CardInfo で追加し、デッキは blueprint へマッピング）。
  - デッキへ追加するカードからは、[新規]タグは除外してください。
- 報酬消化後の挙動: 全報酬消化必須か、任意でフィールドへ戻れるか → デモでは任意で「フィールドに戻る」を許可。
  - 全報酬消化必須とします。
  - 報酬リストは、勝利状態のBattleのインスタンスから取得できる形にします。今回はメソッドはMockでOKです。
- 実戦統合: 本実装では BattleView から勝利時にモーダルを開く必要があるが、今回はデモのみを作成。
  - 今回はデモのみでOKです。